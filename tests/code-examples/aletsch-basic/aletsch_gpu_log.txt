2024-03-25 14:57:47.102006: I metal_plugin/src/device/metal_device.cc:1154] Metal device set to: Apple M1 Pro
2024-03-25 14:57:47.102048: I metal_plugin/src/device/metal_device.cc:296] systemMemory: 16.00 GB
2024-03-25 14:57:47.102057: I metal_plugin/src/device/metal_device.cc:313] maxCacheSize: 5.33 GB
2024-03-25 14:57:47.102095: I tensorflow/core/common_runtime/pluggable_device/pluggable_device_factory.cc:306] Could not identify NUMA node of platform GPU ID 0, defaulting to 0. Your kernel may not have been built with NUMA support.
2024-03-25 14:57:47.102121: I tensorflow/core/common_runtime/pluggable_device/pluggable_device_factory.cc:272] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 0 MB memory) -> physical PluggableDevice (device: 0, name: METAL, pci bus id: <undefined>)
2024-03-25 14:57:47.817497: I tensorflow/core/grappler/optimizers/custom_graph_optimizer_registry.cc:117] Plugin optimizer for device_type GPU is enabled.
/Users/afisc/igm_venv/lib/python3.10/site-packages/tensorflow/python/framework/tensor_util.py:518: RuntimeWarning: overflow encountered in cast
  nparray = np.array(values, dtype=np_dt)
Found pretrained emulator in the igm package: pinnbp_10_4_cnn_16_32_2_1
IGM %s :         Iterations   |         Time (y)     |     Time Step (y)   |   Ice Volume (km^3) 
IGM 14:57:55 :           0    |          1900        |        0.47        |          13.75 
IGM 14:58:01 :          31    |          1910        |        0.23        |          13.88 
IGM 14:58:09 :          76    |          1920        |        0.19        |          14.01 
IGM 14:58:20 :         134    |          1930        |        0.19        |          14.18 
IGM 14:58:30 :         187    |          1940        |        0.20        |          14.40 
IGM 14:58:41 :         241    |          1950        |        0.19        |          14.74 
IGM 14:58:51 :         297    |          1960        |        0.18        |          15.10 
IGM 14:59:02 :         355    |          1970        |        0.18        |          15.42 
IGM 14:59:13 :         411    |          1980        |        0.18        |          15.67 
IGM 14:59:23 :         466    |          1990        |        0.18        |          15.86 
IGM 14:59:34 :         520    |          2000        |        0.19        |          15.98 
Memory statistics report:
                            U  |  size :   0.0016 Gb  
                            V  |  size :   0.0016 Gb  
                            W  |  size :   0.0016 Gb  
                        usurf  |  size :   0.0002 Gb  
                          thk  |  size :   0.0002 Gb  
                      icemask  |  size :   0.0002 Gb  
                            X  |  size :   0.0002 Gb  
                            Y  |  size :   0.0002 Gb  
                           dX  |  size :   0.0002 Gb  
                         topg  |  size :   0.0002 Gb  
                    arrhenius  |  size :   0.0002 Gb  
                    slidingco  |  size :   0.0002 Gb  
                     uvelbase  |  size :   0.0002 Gb  
                     vvelbase  |  size :   0.0002 Gb  
                         ubar  |  size :   0.0002 Gb  
                         vbar  |  size :   0.0002 Gb  
                     uvelsurf  |  size :   0.0002 Gb  
                     vvelsurf  |  size :   0.0002 Gb  
                        lsurf  |  size :   0.0002 Gb  
                          smb  |  size :   0.0002 Gb  
                      divflux  |  size :   0.0002 Gb  
                     wvelbase  |  size :   0.0002 Gb  
                     wvelsurf  |  size :   0.0002 Gb  
             weight_particles  |  size :   0.0002 Gb  
                   velbar_mag  |  size :   0.0002 Gb  
                  velsurf_mag  |  size :   0.0002 Gb  
                         xpos  |  size :   0.0000 Gb  
                         ypos  |  size :   0.0000 Gb  
                         zpos  |  size :   0.0000 Gb  
                        rhpos  |  size :   0.0000 Gb  
                         wpos  |  size :   0.0000 Gb  
                         tpos  |  size :   0.0000 Gb  
                        englt  |  size :   0.0000 Gb  
                        nxpos  |  size :   0.0000 Gb  
                        nypos  |  size :   0.0000 Gb  
                        nzpos  |  size :   0.0000 Gb  
                       nrhpos  |  size :   0.0000 Gb  
                        nwpos  |  size :   0.0000 Gb  
                        ntpos  |  size :   0.0000 Gb  
                       nenglt  |  size :   0.0000 Gb  
                            y  |  size :   0.0000 Gb  
Computational statistics report:
                   smb_simple  |  mean time per it :   0.0120  |  total :   1.0795  |  number it  :       90
                      iceflow  |  mean time per it :   0.0386  |  total :  20.1273  |  number it  :      521
                         time  |  mean time per it :   0.0053  |  total :   2.7401  |  number it  :      521
                          thk  |  mean time per it :   0.0091  |  total :   4.7573  |  number it  :      521
                    vert_flow  |  mean time per it :   0.1055  |  total :  54.9728  |  number it  :      521
                    particles  |  mean time per it :   0.0335  |  total :  17.4721  |  number it  :      521
                   write_ncdf  |  mean time per it :   0.0169  |  total :   0.1859  |  number it  :       11
                       plot2d  |  mean time per it :   0.3220  |  total :   3.5419  |  number it  :       11
